/*
 * Debug_RTOS.c
 *
 *  Created on: ??þ/??þ/????
 *      Author: YUSSRY
 */


/*
*********************************************************************************************************
*                                     MICIRUM BOARD SUPPORT PACKAGE
*
*                             (c) Copyright 2012; Micrium, Inc.; Weston, FL
*
*               All rights reserved.  Protected by international copyright laws.
*               Knowledge of the source code may NOT be used to develop a similar product.
*               Please help us continue to provide the Embedded community with the finest
*               software available.  Your honesty is greatly appreciated.
*********************************************************************************************************
*/

/*
*********************************************************************************************************
*
*                                        BOARD SUPPORT PACKAGE
*
*                                         Xilinx Zynq XC7Z020
*                                               on the
*
*                                             Xilinx ZC702
*                                          Evaluation Board
*
* Filename      : bsp.c
* Version       : V1.00
* Programmer(s) : JPB
*********************************************************************************************************
*/

/*
*********************************************************************************************************
*                                             INCLUDE FILES
*********************************************************************************************************
*/

#define Debug_RTOS_IMPORT
#include "Debug_RTOS.h"



/*
*********************************************************************************************************
*                                            LOCAL DEFINES
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                           LOCAL CONSTANTS
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                          LOCAL DATA TYPES
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                            LOCAL TABLES
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                       LOCAL GLOBAL VARIABLES
*********************************************************************************************************
*/

OS_EVENT *StubPendMbox;

/*
*********************************************************************************************************
*                                      LOCAL FUNCTION PROTOTYPES
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                             REGISTERS
*********************************************************************************************************
*/




/*
*********************************************************************************************************
*                                            REGISTER BITS
*********************************************************************************************************
*/




/*
*********************************************************************************************************
*                                     LOCAL CONFIGURATION ERRORS
*********************************************************************************************************
*/





/*
*********************************************************************************************************
*                                               Debug_RTOS_Init()
*
* Description :
*
* Argument(s) : none.
*
* Return(s)   : none.
*
* Caller(s)   : .
*
* Note(s)     : (1)
*
*               (2)
*********************************************************************************************************
*/

void Debug_RTOS_Init(void)
{

	/*point to the underlying RTOS Thread List*/
	Debug_RTOS_ThreadListPtr = (Debug_MemWidth *)OSTCBPrioTbl ;
	//current_thread_OF_Focus = Debug_RTOS_GET_HPT();	/*update current_thread_OF_Focus with HPT ID*/
	current_thread_OF_Focus = APP_CFG_TASK_START_PRIO;
	StubPendMbox = OSMboxCreate((void *)0);
}
/*
*********************************************************************************************************
*                                              Debug_RTOS_GET_HPT ()
*
* Description :
*               -
*               -
*
* Argument(s) : None
*
* Return(s)   : Priority of HPT Application Task  in Ready List
*
*
* Caller(s)   :
*
* Note(s)     : (1)
*
*               (2)
*********************************************************************************************************
*/

Debug_TID_t Debug_RTOS_GET_HPT(void)
{

}

/*
*********************************************************************************************************
*                                              Debug_RTOS_StubPend ()
*
* Description :
*               -
*               -
*
* Argument(s) : None
*
* Return(s)   : the received stub message if no errors
*               0 if receiving message fails
*
*
* Caller(s)   :callback by Debug_RSP_Process_Packet() RSP Module
*
* Note(s)     : (1)
*
*               (2)
*********************************************************************************************************
*/
Debug_Block_Message_t Debug_RTOS_StubPend(void)
{
	INT8U     perr;

	Debug_Block_Message_t *stub_Messageptr = (Debug_Block_Message_t *)OSMboxPend(StubPendMbox,0,&perr);
   if(stub_Messageptr != (void *)0)
	   return (*stub_Messageptr);
   else
       return 0;
}

/*
*********************************************************************************************************
*                                              Debug_RTOS_StubPost ()
*
* Description :
*               -
*               -
*
* Argument(s) : PostMessage : Stub Message to be sent to Stub Task
*
* Return(s)   :none
*
*
* Caller(s)   :
*
* Note(s)     : (1)
*
*               (2)
*********************************************************************************************************
*/
void Debug_RTOS_StubPost(void *PostMessage)
{
	INT8U     perr;
	perr = OSMboxPost (StubPendMbox, PostMessage);
	/*TODO  ::
	 * Do we need to handle if MBOX is full or it will not happen*/
	/*if (perr == OS_ERR_MBOX_FULL)
	{}
	*/

}

